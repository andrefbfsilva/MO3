# CHANGELOG - MO3 (VersÃ£o LocalStorage)
# Control-m Batch Knowledge Database
# AndrÃ©Tools - Por AndrÃ© Filipe Silva
# Formato baseado em Keep a Changelog (https://keepachangelog.com/)
# Versionamento SemÃ¢ntico (https://semver.org/)

## [1.2.6] - 2025-08-26

### ğŸš¨ CRITICAL UX FIX - DigitaÃ§Ã£o Fluida nos Campos
- **PROBLEMA RESOLVIDO**: Campos de input perdiam foco apÃ³s cada tecla digitada, impossibilitando digitaÃ§Ã£o fluida
- **MÃšLTIPLAS CAUSAS IDENTIFICADAS**: React development mode + atributos "key" + handlers inline + inputs controlados complexos
- **SOLUÃ‡ÃƒO DEFINITIVA**: MigraÃ§Ã£o para inputs nÃ£o controlados com refs para modais de ediÃ§Ã£o

### Fixed
- ğŸ’¥ **BUG CRÃTICO - Perda de Foco em Inputs**: Inputs perdiam foco apÃ³s cada tecla digitada
- ğŸ”‘ **Atributos "key" ProblemÃ¡ticos**: Removidos keys que causavam recriaÃ§Ã£o de componentes
- ğŸš€ **React Development Mode**: Migrado para React production (sem double rendering)
- ğŸ“ **Handlers Inline InstÃ¡veis**: Convertidos para funÃ§Ãµes estÃ¡veis declaradas
- ğŸ¯ **Inputs Controlados Complexos**: SubstituÃ­dos por uncontrolled inputs + refs

### Changed  
- âš¡ **React Production Mode**: Migrado de development para production (performance + estabilidade)
- ğŸ·ï¸ **TÃ­tulos de Modal EstÃ¡ticos**: Removido tÃ­tulo dinÃ¢mico baseado em editingId
- ğŸ”— **Arquitetura de Inputs**: Modal APP agora usa uncontrolled inputs com defaultValue + refs
- ğŸ“‹ **Handlers EstÃ¡veis**: FunÃ§Ãµes onChange declaradas fora do JSX para estabilidade

### Added
- ğŸ“š **DocumentaÃ§Ã£o AvanÃ§ada**: Guia completo de prevenÃ§Ã£o de problemas de digitaÃ§Ã£o
- ğŸ›¡ï¸ **Checklist de PrevenÃ§Ã£o**: Lista de verificaÃ§Ã£o para novos inputs
- ğŸ”§ **Debugging Steps**: Processo estruturado para diagnosticar problemas de foco
- ğŸ“‹ **Sinais de Alerta**: IdentificaÃ§Ã£o precoce de problemas de UX

### Technical Details
- **SoluÃ§Ã£o HÃ­brida**: `React.useRef()` + `defaultValue` + `useEffect` para sincronizaÃ§Ã£o
- **Leitura de Valores**: `inputRef.current?.value || fallbackValue` na submissÃ£o
- **Preenchimento AutomÃ¡tico**: `useEffect` preenche refs quando entra em modo ediÃ§Ã£o
- **Arquitetura**: Uncontrolled inputs mantÃªm foco + refs permitem leitura quando necessÃ¡rio
- **Performance**: React.production.min.js elimina re-renders desnecessÃ¡rios

---

## [1.2.5] - 2025-08-26

### Fixed
- ğŸ¯ **BUG CRÃTICO - Escalas Obsoletas em Conflitos**: Refinada detecÃ§Ã£o para mostrar apenas escalas ativas por PoolSuporte
- â° **SobreposiÃ§Ã£o Temporal**: Corrigido critÃ©rio de sobreposiÃ§Ã£o (< em vez de <=) para evitar detectar "toque" como conflito
- ğŸ§  **LÃ³gica Inteligente de Agrupamento**: Agrupa por PoolSuporte e compara apenas as mais recentes

### Changed
- ğŸ“Š **DetecÃ§Ã£o Baseada em Pools Ativos**: SÃ³ mostra conflito entre PoolSuporte diferentes com escalas ativas
- ğŸ” **Interface Limpa**: Remove escalas obsoletas dos cards de duplicaÃ§Ã£o
- ğŸ“‹ **Logging Estruturado**: Console mostra agrupamento por pool e identificaÃ§Ã£o de escalas ativas

### Added
- ğŸ“¦ **Agrupamento por PoolSuporte**: Nova lÃ³gica que agrupa escalas por pool antes de comparar
- ğŸ† **Escalas Ativas**: Identifica e trabalha apenas com a escala mais recente de cada pool

### Technical Details
- Algoritmo de agrupamento: `groupedByPool[pool].push(escala)`
- Filtro de escalas ativas: `latestByPool[pool] = poolEscalas[0]`
- DetecÃ§Ã£o de conflito: `activeEscalas.length > 1`
- SobreposiÃ§Ã£o temporal: `inicio1 < fim2 && inicio2 < fim1` (evita "toque")
- Interface: `allEscalas: activeEscalas` (apenas escalas ativas)

---

## [1.2.4] - 2025-08-26

### Fixed
- ğŸ¯ **BUG CRÃTICO - DuplicaÃ§Ãµes por PoolSuporte**: Refinada lÃ³gica de duplicaÃ§Ã£o baseada em PoolSuporte
- ğŸ§  **LÃ³gica Inteligente**: Mesmo PoolSuporte = substituiÃ§Ã£o natural, PoolSuporte diferente = duplicaÃ§Ã£o real

### Changed
- ğŸ” **DetecÃ§Ã£o de DuplicaÃ§Ã£o Refinada**: Considera PoolSuporte como critÃ©rio principal de conflito
- ğŸ“Š **Logging Melhorado**: Console mostra motivo da duplicaÃ§Ã£o (PoolSuporte vs Temporal)

### Technical Details
- Nova lÃ³gica: `poolSuporteDifferent OR (samePoolSuporte AND temporalOverlap)`
- Escalas com mesmo PoolSuporte e datas diferentes â†’ Mostra apenas a mais recente
- Escalas com PoolSuporte diferente â†’ Sempre marca como duplicaÃ§Ã£o
- Variable `duplicationReason` identifica causa especÃ­fica do conflito

---

## [1.2.3] - 2025-08-26

### Fixed
- ğŸ› **BUG - CritÃ©rio de Data Mais Recente**: Corrigido parser de datas que era muito restritivo (year >= 2020)
- ğŸ“… **ValidaÃ§Ã£o de Anos FlexÃ­vel**: Aceita escalas desde 1990 atÃ© 2050 para maior abrangÃªncia
- ğŸ”¢ **Suporte Anos 2-DÃ­gitos**: ConversÃ£o automÃ¡tica de anos YY para YYYY (00-49 â†’ 2000-2049, 50-99 â†’ 1950-1999)
- âš–ï¸ **OrdenaÃ§Ã£o Consistente**: Adicionado critÃ©rio secundÃ¡rio por PoolSuporte quando datas sÃ£o iguais
- ğŸ¯ **BUG CRÃTICO - DuplicaÃ§Ãµes Falsas**: Corrigido detector que mostrava duplicaÃ§Ã£o para escalas sequenciais

### Changed
- ğŸ“Š **Logging Melhorado**: Console logs mais detalhados mostrando todas as escalas ordenadas por data
- ğŸ” **Debug AvanÃ§ado**: InformaÃ§Ã£o adicional sobre timestamp parsing e seleÃ§Ã£o de escalas
- ğŸ§  **DetecÃ§Ã£o Inteligente de DuplicaÃ§Ãµes**: SÃ³ marca como duplicaÃ§Ã£o quando hÃ¡ sobreposiÃ§Ã£o temporal real

### Added
- â° **VerificaÃ§Ã£o de SobreposiÃ§Ã£o Temporal**: FunÃ§Ã£o checkTemporalOverlap() para identificar conflitos reais
- ğŸ”„ **SubstituiÃ§Ãµes Naturais**: Reconhece escalas que sÃ£o meras atualizaÃ§Ãµes/substituiÃ§Ãµes temporais

### Technical Details
- Parser de datas expandido para aceitar range de 1990-2050 (anteriormente 2020-2050)
- FunÃ§Ã£o parseDate() com suporte para anos de 2 dÃ­gitos
- OrdenaÃ§Ã£o secundÃ¡ria por PoolSuporte.localeCompare() em caso de datas iguais
- Logs estruturados mostrando processo completo de seleÃ§Ã£o da escala mais recente
- Algoritmo de sobreposiÃ§Ã£o temporal: escala1.inicio â‰¤ escala2.fim && escala2.inicio â‰¤ escala1.fim
- Escalas sem data fim sÃ£o consideradas ativas (comparadas com data atual)
- hasDuplicates = false quando escalas sÃ£o apenas substituiÃ§Ãµes sequenciais

---

## [1.2.2] - 2025-08-12

### Added
- ğŸš¨ **Interface AvanÃ§ada de DuplicaÃ§Ãµes**: Card especializado para gestÃ£o de escalas duplicadas
- ğŸ“‹ **Contactos Completos**: Mostra Contacto1, Contacto2, Contacto3 de AMBAS as escalas quando hÃ¡ duplicaÃ§Ã£o
- ğŸ¢ **Processos de Escalada**: Exibe Coordenador e Diretor de cada escala separadamente
- âš ï¸ **ValidaÃ§Ã£o Manual**: Prompt "Por favor validar qual Ã© a escala correcta!" substituindo seleÃ§Ã£o automÃ¡tica

### Changed
- ğŸ” **DetecÃ§Ã£o de DuplicaÃ§Ãµes**: FunÃ§Ã£o `findEscalaInfo()` retorna objeto com `hasDuplicates` e `allEscalas`
- ğŸ“ **Modal Responsivo**: Card expande automaticamente (max-w-lg) quando hÃ¡ duplicaÃ§Ã£o para acomodar informaÃ§Ã£o extra
- ğŸ¨ **Interface Visual**: Aviso vermelho proeminente + secÃ§Ãµes separadas para cada escala com PoolSuporte identificado

### Technical Details
- Estrutura de retorno: `{ ...escalaData, hasDuplicates: boolean, allEscalas: array }`
- Interface condicional: layout diferente para escalas Ãºnicas vs duplicadas
- Logs de debug melhorados com PoolSuporte para troubleshooting de duplicaÃ§Ãµes
- Compatibilidade mantida: escala "ativa" continua acessÃ­vel via propriedades base

---

## [1.2.1] - 2025-08-05

### Fixed
- ğŸ› **BUG - ImportaÃ§Ã£o Excel Standby**: Corrigido campo vazio interpretado como TRUE, agora campo vazio = sem standby (FALSE)
- ğŸ” **BUG - Busca Escalas**: Corrigido problema de espaÃ§os em branco nos catÃ¡logos aplicacionais impedindo abertura dos cards
- ğŸ§¹ **ComparaÃ§Ã£o Robusta**: Implementado `.trim()` nas comparaÃ§Ãµes de ITSMAssetID para ignorar espaÃ§os acidentais

### Changed
- ğŸ“ **DocumentaÃ§Ã£o Import**: Atualizada descriÃ§Ã£o de exemplos para refletir que campo vazio â†’ âŒ (sem standby)

### Technical Details
- FunÃ§Ã£o `findEscalaInfo()` agora usa comparaÃ§Ã£o `toString().trim()` para robustez
- Sistema de debug temporÃ¡rio implementado e removido apÃ³s identificaÃ§Ã£o do problema
- Logs de debug melhorados para troubleshooting futuro

---

## [1.2.0] - 2025-08-04

### Added
- ğŸŒ¸ **IntegraÃ§Ã£o com Escalas de Suporte**: Modal para carregar e consultar escalas XML/ZIP
- ğŸ” **DetecÃ§Ã£o de Conflitos CA**: Identifica automaticamente CatÃ¡logos Aplicacionais duplicados
- ğŸ“… **CritÃ©rio de Data Mais Recente**: Resolve conflitos usando coluna INICIO mais recente
- ğŸ·ï¸ **Campo CatÃ¡logo Aplicacional**: Novo campo no mÃ³dulo App com ligaÃ§Ã£o Ã s escalas
- ğŸ”„ **Cards com InformaÃ§Ãµes de Escalas**: Clique nos CA para ver contactos e hierarquia

### Fixed
- ğŸ“… **BUG CRÃTICO - Formato de Datas**: Corrigido parsing de DD/MM/YYYY vs MM/DD/YYYY americano
- â¹ï¸ **Problemas de Foco**: Adicionadas chaves Ãºnicas aos campos de entrada para manter foco
- ğŸ”„ **MigraÃ§Ã£o de Dados**: Incluir catalogoAplicacional em migraÃ§Ãµes automÃ¡ticas

### Changed
- ğŸ“ **DocumentaÃ§Ã£o**: Atualizado CLAUDE.md com padrÃµes de datas e novas funcionalidades
- ğŸ§™ **Estados Removidos**: Eliminados estados SEED/SPROUTING/etc. nÃ£o utilizados

### Technical Details
- Parser de datas robusto com validaÃ§Ã£o de formato portuguÃªs
- FunÃ§Ã£o findEscalaInfo() com resoluÃ§Ã£o de conflitos por timestamp
- Logs de debug para troubleshooting de conflitos CA
- Suporte completo para XML das Escalas de Suporte do Control-M

---

## [1.1.0] - 2025-07-31

### ğŸš¨ CRITICAL PERFORMANCE FIX
- **PROBLEMA RESOLVIDO**: AplicaÃ§Ã£o consumia 500MB+ de RAM para um JSON de apenas 76KB
- **CAUSA**: TailwindCSS CDN carregava ~50.000 classes CSS nÃ£o utilizadas (~180MB)
- **SOLUÃ‡ÃƒO**: SubstituÃ­do CDN por CSS inline otimizado com apenas as classes necessÃ¡rias
- **IMPACTO**: ReduÃ§Ã£o de 231MB para ~50MB no Chrome (78% menos memÃ³ria!)

### Added
- Sistema de pesquisa otimizada com mÃ­nimo de 3 caracteres
- Estado vazio elegante quando nÃ£o hÃ¡ pesquisa ativa
- Indicador de caracteres restantes para ativar pesquisa
- Contador de resultados encontrados vs total de registos
- DocumentaÃ§Ã£o inline detalhada sobre otimizaÃ§Ã£o Tailwind

### Changed
- Removido TailwindCSS CDN (`https://cdn.tailwindcss.com`)
- Implementado CSS inline personalizado com ~200 classes (vs ~50.000 do CDN)
- Tabelas agora sÃ³ renderizam quando hÃ¡ pesquisa ativa (3+ caracteres)
- Interface simplificada sem renderizar milhares de registos desnecessariamente
- CSS organizado por categorias para facilitar manutenÃ§Ã£o

### Performance Improvements
- **MemÃ³ria antes**: 500MB (Edge) / 162MB (Chrome) com dados carregados
- **MemÃ³ria depois**: ~40-50MB com pesquisa otimizada
- **RenderizaÃ§Ã£o**: De 5638 componentes sempre visÃ­veis para 0-50 conforme pesquisa
- **Tempo de carregamento**: InstantÃ¢neo (nÃ£o precisa renderizar tabelas inicialmente)

### Technical Details
- Heap Snapshot revelou 182MB (79%) eram "Other non-JS objects (HTML/CSS)"
- React Development Mode com 62,473 FiberNodes
- SoluÃ§Ã£o: CSS inline + lazy rendering de componentes
- CompatÃ­vel com Chrome e Edge (embora Edge use mais memÃ³ria por design)

---

## [1.0.0] - 2025-07-28

### Initial Release - MO3 (VersÃ£o LocalStorage)

### Core Features
- **MÃ³dulo App**: GestÃ£o de aplicaÃ§Ãµes e sub-aplicaÃ§Ãµes com controlo de standby
- **MÃ³dulo Cadeia**: Controlo de cadeias de processos batch
- **MÃ³dulo Erro**: Base de conhecimento de erros e instruÃ§Ãµes de resoluÃ§Ã£o
- **AnÃ¡lise de Logs**: IdentificaÃ§Ã£o automÃ¡tica de erros em logs com contexto
- **ImportaÃ§Ã£o em Massa**: Suporte completo para Excel (.xlsx, .xls)
- **PersistÃªncia LocalStorage**: Dados offline sem necessidade de backend

### User Interface
- Design moderno com React 18 e gradientes vibrantes
- Cards informativos com contadores de registos
- Interface responsiva para desktop e tablet
- Ãcones SVG inline personalizados
- Modais para adiÃ§Ã£o e ediÃ§Ã£o de dados

### Import/Export
- Export completo em JSON com timestamp
- Import de backups JSON
- ImportaÃ§Ã£o massa de Excel com mapeamento flexÃ­vel
- DetecÃ§Ã£o inteligente de campos "Sem Standby" (case-insensitive)
- Preview de dados antes da importaÃ§Ã£o

### Search & Filter
- Pesquisa global em todos os campos
- Filtro em tempo real
- Destaque de resultados

### Technical Stack
- React 18 (Development mode)
- Babel standalone para transpilaÃ§Ã£o no browser
- XLSX library para processamento Excel
- LocalStorage para persistÃªncia de dados
- TailwindCSS via CDN
- Single-file application (~15KB HTML)

### Developer
- AndrÃ© Filipe Silva
- andrefbfsilva@gmail.com
- AndrÃ©Tools - Faster Operational Knowledge

---

# Notas de VersÃ£o

## ConvenÃ§Ãµes
- **MAJOR**: MudanÃ§as incompatÃ­veis na estrutura de dados
- **MINOR**: Novas funcionalidades mantendo compatibilidade
- **PATCH**: CorreÃ§Ãµes de bugs e melhorias menores

## Categorias
- **Added**: Funcionalidades novas
- **Changed**: AlteraÃ§Ãµes em funcionalidades existentes
- **Deprecated**: Funcionalidades marcadas para remoÃ§Ã£o
- **Removed**: Funcionalidades removidas
- **Fixed**: CorreÃ§Ãµes de bugs
- **Security**: CorreÃ§Ãµes de vulnerabilidades
- **Performance Improvements**: OtimizaÃ§Ãµes de performance